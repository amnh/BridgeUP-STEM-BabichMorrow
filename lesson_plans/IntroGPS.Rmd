---
title: "Intro to GPS"
author: "Cecina Babich Morrow"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Adapted from lesson plan by Professors Harbert and Blair: https://rsh249.github.io/spatial_bioinformatics/GPStoGISwithText.html.

## Import data to R

Start by opening a new script file in RStudio. Instead of just editing this R Markdown file (although you can and should add your own notes to it!), you can save the code for this analysis in that script file. Start the file with a helpful comment, for example:

```{r}
# Gladys Phyllis Smith
# 03/04/1973
# Script for analyzing GPS points
```


Now go to the "Environment" tab of RStudio (top right panel) and select "Import Dataset" > "From Text (readr) ..." Use the "Browse" to navigate to and select the data file you just saved (for Android users, select the .csv, not the .txt). Check over the formatting options to make sure everything looks okay. When you're satisfied, click "Import". When you do that, code will run in your console (see example below). Copy and paste that code into your new R script and add a helpful comment, like `# Import dataset from .csv`. 

```{r}
# Import android data
library(readr)
androiddata_test <- read_csv("gps_test_data/androiddata_test.csv")

# Import iPhone data
iphonedata_test <- read_csv("gps_test_data/iphonedata_test.csv")
```

Now take a look at the data using either the `View()` or `head()` function.

```{r}
head(androiddata_test)
head(iphonedata_test)
```

To map these data, we need to make sure the columns for latitude and longitude are called "lat" and "lon". Check out what the current column names for the data are:

```{r}
names(iphonedata_test)
names(androiddata_test)
```

To rename a column in R, you can do something similar to what we did in the Intro to R lesson where you renamed elements in the vector `intern_names`.

**Try it yourself:** Add code in the following chunks to rename the correct columns so they are named "lat" and "lon":

```{r}

```


## Visualize data

We need to download a few required packages:

```{r}
require(raster) #package to analyze gridded spatial data
require(sp) #package to provide classes and methods for spatial data
require(rgdal) #allows R to access a library called GDAL
require(ggplot2) #plotting package in R
devtools::install_github("dkahle/ggmap", ref = "tidyup") #package to visualize spatial data and models
require(ggmap)
```

We can start by plotting the points onto a map from GoogleEarth. Google has made it necessary to obtain an API key, which is a way to let two applications talk to each other. Since you have to enter a credit card number to get the API (even though it's free), we're going to use the one I set up. 

```{r}
api_key = "AIzaSyBK7lLbqoqnYFdzf-idYYposb-1gwyRAlQ"
register_google(key = api_key)
```

We also need to determine the range of latitudes and longitudes containing your points. We can do that by making a bounding box.



```{r}
loc = cbind(c(min(wps$lon), max(wps$lon)), c(min(wps$lat), max(wps$lat)))
```


Now we can do some plotting:

```{r}
map <- get_map(maptype = "satellite", source = "google")
ggmap(map) + 
  geom_point(data = androiddata_test, 
             color = "red",
             size =1)
```



